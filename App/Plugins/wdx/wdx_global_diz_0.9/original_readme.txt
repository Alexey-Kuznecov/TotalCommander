GlobalDiz Content Plugin for Total Commander 6.50+ 
Version: 0.8b
Автор: Павел Дубровский aka D1P

Описание:
Плагин позволяет сортировать файлы и папки по группам, а также устанавливать описания для файлов.

Установка:
Описание установки для TC 6.50 En.
Распакуйте архив куда вам будет удобно (например в папку c:\tc\plugins\wdx\global_diz).
В TC выберите Configuration -> Plugins -> Content Plugins (.WDX) -> Configure -> Add -> Выбирайте c:\tc\plugins\wdx\global_diz\global_diz.wdx -> OK -> OK -> OK. :)

Настройка:
В архиве с плагином идёт пример ini-файла с комментариями.
Файл должен находиться в каталоге с плагином, либо по адресу, прописнному в реестре (HKEY_CURRENT_USER\Software\Legion\GlobalDiz, ключ IniFileName).

Пользовательские колонки:

Плагин поддерживает работу с пользовательскими колонками описаний. Таких колонок может быть 10 штук максимум.
Для создания новой колонки запустите add_diz.exe FILENAME /G. Выберите User Column, и в выпадающем списке введите полный путь к файлу, который будет хранить описания для данной колонки. Название новой колонки будет такое же, как название файла. В строке описания можете добавить описание для файла.
Нажмите OK и перезапустите TC. После этого, в настройках плагина появится новая колонка.
Добавление новых колонок и записей в них производится аналогично указанному выше. Список существующих колонок отображается в выпадающем списке.
См. также ключи командной строки для работы с пользовательскими колонками.
Функции очистки списков для пользовательских колонок пока нет.


Работа:
Добавление описаний и групп для файлов осуществляется программой add_diz.exe. Проще всего это сделать через командную строку.

Ключи командной строки для add_diz.exe:

/? - Экран с короткой справкой по параметрам программы. Пример:
add_diz.exe /?

/O - диалог настройки плагина. Пример:
add_diz.exe /o

/G или /GUI - запуск утилиты в оконном режиме. Пример: 
add_diz.exe c:\some\file.txt /g

Если имя файла не указано, появится диалог выбора файла.

/C или /CLEAR - очистка списка файлов от лишних записей (они появляются, если файл был переименован или удалён). Работа с файлами не производится. Пример:
add_diz.exe /c

/DIZ=ОПИСАНИЕ ФАЙЛА - добавляет описание для файла. Используется в комбинации с ключами /GROUP и /USER, либо отдельно. Пример:
add_diz.exe /diz="Описание файла" c:\some\file.txt

add_diz.exe /diz=? c:\some\file.txt - Вызов диалога запроса комментария для файла.

/GROUP=ИМЯ ГРУППЫ - добавление файла в группу. Пример:
add_diz.exe /group=WORK c:\some\file.txt

/USER=ИМЯ ПОЛЬЗОВАТЕЛЬСКОЙ КОЛОНКИ - добавляет файл в пользовательскую колонку. Пользовательская колонка указывается как имя файла (название колонки будет отображаться, как имя файла без расширения). Пример:
add_diz.exe /user=Название.diz /diz="Отчёт о работе" c:\some\file.txt

Если пользовательская колонка с таким названием не существует, то необходимо перезапустить TC и настроить Custom Columns для отображения этой колонки.

/D или /DELETE - удаление файла из группы/пользовательской колонки. Примеры:
add_diz.exe /delete c:\some\file.txt - удаляет файл c:\some\file.txt из группы, в которой он находится.

add_diz.exe /delete /user=Название.diz c:\some\file.txt - удаляет файл c:\some\file.txt из пользовательской колонки Название.

add_diz.exe /delete /list=c:\file.tmp - удаление всех файлов из листа из групп, которые им присвоены.

Передаваемый файл определяется автоматически (ключ для него не является обязательным). Однако, если возникают проблемы с автоопределением имени файла (например при передаче списка через %L на Win9x), можно воспользоваться следующими ключами:

/FILE=c:\some\file.txt (Задать имя файла, автоопределение не используется).

/LIST=c:\some\file.tmp (Задание имени файла с указанием того, что это - список файлов).

Порядок ключей, а также регистр написания значения не имеют (т.е. можно чередовать ключи как угодно). При задании несовместимых ключей (например /user и /group одновременно) обрабатывается последний указанный ключ. Если в значении любого ключа имеются пробелы, заключите его в кавычки (пример: /DIZ="Описание, в котором есть пробелы").

Также см. bat-файлы в архиве. Думаю, приделать add_diz.exe на панель TC никому труда не составит.
При работе через GUI (add_diz.exe /gui) всё интуитивно понятно и объяснений не требует.

Добавление пункта в контекстное меню Windows:
Откройте настройки плагина (add_diz.exe /o), затем установите, какая команда будет выполняться при выполнении этого пункта меню.
Если вы хотите добавить файл в группу, выберите "Add selected file to group", и укажите в списке снизу название группы, в которую будет происходить добавление.
Если вы хотите добавить файл в пользовательскую колонку, выберите "Add selected file to user column", и укажите в списке снизу название колонки, в которую будет происходить добавление.
При выборе "Show GUI" будет вызываться окно программы.

В поле "Description for selected file (leave blank for none)" укажите комментарий для выбираемого файла. Оставьте его пустым, если комментарий не нужен, либо поставьте символ знака вопроса ("?") для вывода окошка с запросом комментария.

В поле "Menu item name" введите название пункта меню.

Нажмите на кнопку "Set". Теперь в контентном меню для всех файлов и папок появится новый пункт, запускающий add_diz с выбранными параметрами.
На данный момент средствами программы возможно добавление только одного пункта в меню (например, только для добавления в самую часто используемую группу), возможно, в дальнейшем это изменится.


История

v 0.1
Первая тестовая версия.

v 0.2
Вторая тестовая версия.
[+] add_diz работает с параметрами командной строки либо через GUI.
[!] Настройки считываются только при первом обращении к плагину, поэтому после смены настроек плагина нужно перезапустить TC.
[+] Добавлена функция "очистки" списка.
[+] Плагин понимает параметр %l (%L тоже вроде работает, но %l предпочтительнее).

v 0.3
[*] Исправлено: появление ошибки, если в списке была пустая строка.
[+] Настройки вынесены в Ini-файл.
[+] Добавлены пользовательские колонки описателей (10 колонок максимум).
[*] Соответствующие добавления в add_diz.exe

v 0.4b
[*] Убраны отладочные messagebox`ы в add_diz.exe
[*] Убрана "непонятная закорючка" в диалоге поиска.
[*] Изменены параметры командной строки (см. "Настройка", а также примеры bat-файлов).
[+] Если при запуске add_diz.exe в оконном режиме обрабатываемый файл не указан, появляется диалог выбора файла.
[+] Поддержка стилей XP для оконного режима.
[+] Ключ RefreshPanels в ini-файле. При включении заставляет TC перечитывать панели (и, соответственно, описания).
[*] Убран параметр GlobalDizFile из ini-файла. Его заменил параметр GlobalDizFolder - см. комментарии в ini-файле.
[+] Файл, в котором хранятся данные всегда называется global.diz. Каждый раз проверяется его существование, при отсутствии файла он пересоздаётся.
[+] Робкие попытки добавить несколько иконок :)
[+] При работе со списком (%L) в оконном режиме выводится надпись 'Set description for list of files'.
[*] Коректное добавление описания при передаче параметров списком (%L).

v 0.4
[+] Добавлены ключи командной строки /FILE и /LIST (используйте, если автоматическое определение параметров не срабатывает. См. также описания ключей).

17.01.05. v 0.5b
Первый рабочий релиз.
[*] При изменении группы файла старая ссылка удаляется (т.е. файл может входить только в одну группу; для задания нескольких групп можно использовать User Columns).
[+] Диалог подтверждения смены группы (отключается ConfirmReplace=0 в ini-файле). При замене файлов из списка (%L) подтверждение принмается для всех файлов в списке.
[+] Параметр /DELETE для удаления файла из группы (см. описания ключей).
[*] Исправлена ошибка некорректного распознавания ключей при работе в оконном режиме.
[*] Мелкие исправления и добавления.

19.01.05 v 0.6b
[*] Исправлено: /DELETE не всегда работало со списком (параметр %L).
[*] Исправлено: при работе со списком не менялась группа файла, если установлен ConfirmReplace=0.
[+] Если имя файла пользовательской колонки, передаваемое параметром в ключе /USER не имеет расширения (например /USER=somefile), создаваемому файлу автоматически присваивается расширение .diz (получим /USER=somefile.diz).
[*] Удаление повторяющихся ссылок в файлах пользовательских колонок при смене описания.
[+] Ini-файл ищется в папке плагина, и только потом - по записи в реестре. Ini-файл должен называться global_diz.ini
[+] Если параметр GlobalDizFolder пуст, то используется текущая папка.
[+] При значении ключа /DIZ=? выдётся сообщение с запросом описания.
[*] Мелкие исправления и добавления.

21.01.05 v 0.7b
[+] Добавлен диалог настройки плагина.
[+] Ключ /O Вызывает диалог настройки.
[+] Возможность добавления команды для add_diz в контекстное меню Windows.

22.01.05 v 0.7b2
[*] Не работало добавление листа (%L) в пользовательскую колонку.
[*] Убрано "мелькание" окна при работе через командную строку.
[*] Исправлено поведение плагина при неправильном параметре GlobalDizFolder. Если указанная папка не существует, то используется текущая.
[*] Мелкие добавления и исправления.
[+] Добавлено VersionInfo для плагина и add_diz.exe

23.01.05 v 0.8b
[+] Добавлен набор иконок в add_diz.exe.
[+] Небольшой Help-экран при неправильных параметрах (а также по add_diz.exe /?).
[+] English readme file by Сергеич.

27.01.05 v 0.8b2
[*] Исправлено: окно всё равно мелькало :(
[*] У некоторых иконок не было прозрачности.
[*] Не изменялось описание, если файл уже присутствовал в группе.
[*] Мелкие исправления.

Все вопросы принимаются на forum.wincmd.ru.

Благодарности:
Christian Ghisler,
Ergo,
CyberPilgrim,
а также всем участникам обсуждения плагина на forum.wincmd.ru за идеи, и критику, конструктивную и деструктивную :).
Отдельное спасибо Сергеичу за английский перевод readme, всяческое тестирование плагина и множество подкинутых идей.